@using Microsoft.AspNetCore.Http
@using Nsl_Core.Models.Dtos
@using System.Text.Json
@using Nsl_Core.Models.Dtos.Member.Login;
@using Nsl_Core.Models.Infra;
@inject IHttpContextAccessor Accessor
@{
    ViewData["Title"] = "MemberIndex";
    Layout = "~/Views/Shared/_Layout.cshtml";
    LoginDto? user = null;
    string? token = Accessor.HttpContext.Request.Cookies.Get<string>("Login");
    if (token != null)
    {
        user = JsonSerializer.Deserialize<LoginDto?>(JwtHelpers.DecodeToken(token));
    }
}

<main>
    <!-- banner-container -->
    <section>
        <div class="img-fluid banner-box">
            <img src="~/image/banner-5.jpg" alt="image description" class="img-fluid banner-height">
        </div>
    </section>



    <!-- 會員主頁-->
    <div class="container px-4" style="margin-top: 50px; margin-bottom:50px">
        <div class="row gx-5">
            <div class="col-sm-9">
                <div class="p-3 border bg-light">
                    <div class="setting">
                        <!-- 標題 -->
                        <div class="setting-title">老師列表</div>

                        <!-- 內容1 輪播-->

                        <div class="container">
                            <div class="row setting-content">
                                <div id="carouselExampleControls" class="carousel slide"
                                     data-bs-ride="carousel">
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <div id="top4" class="d-flex">
                                            </div>
                                        </div>

                                        <div class="carousel-item ">
                                            <div id="top8" class="d-flex">
                                            </div>
                                        </div>
                                        <div class="carousel-item" >
                                            <div id="top12" class="d-flex">

                                            </div>
                                        </div>
                                        <div class="carousel-item">
                                            <div id="top16" class="d-flex">
                                            </div>
                                        </div>
                                     </div>

                                    <button class="carousel-control-prev" type="button"
                                            data-bs-target="#carouselExampleControls" data-bs-slide="prev"
                                            style="margin-left:-60px;">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"
                                              style="background-color:black"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button"
                                            data-bs-target="#carouselExampleControls" data-bs-slide="next" ;>
                                        <span class="carousel-control-next-icon" aria-hidden="true"
                                              style="background-color:black"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr style="color:brown">
                    <div class="setting">
                        <!-- 標題 -->
                        <div class="setting-title">熱門活動</div>

                        <!-- 內容2 輪播-->
                        <div class="container">
                            <div class="row setting-content">
                                <div id="carouselExampleCaptions" class="carousel slide"
                                     data-bs-ride="carousel">
                                    <div class="carousel-indicators">
                                        <button type="button" data-bs-target="#carouselExampleCaptions"
                                                data-bs-slide-to="0" class="active" aria-current="true"
                                                aria-label="Slide 1"></button>
                                        <button type="button" data-bs-target="#carouselExampleCaptions"
                                                data-bs-slide-to="1" aria-label="Slide 2"></button>
                                        <button type="button" data-bs-target="#carouselExampleCaptions"
                                                data-bs-slide-to="2" aria-label="Slide 3"></button>
                                        

                                    </div>

                                    <div class="carousel-inner">
                                        <div class="carousel-item active">

                                            <img src="~/image/banner-9.jpg" class="d-block w-100"
                                                 alt="" onclick="redirectToDetailPage2()" title="【2023英文補習班推薦】9 大熱門英語課程費用評價總覽">
                                            <div class="carousel-caption d-none d-md-block">
                                            </div>
                                        </div>
                                        <div class="carousel-item">
                                            <img src="~/image/banner-3.jpg" class="d-block w-100"
                                                 alt="" onclick="redirectToDetailPage3()" title="五十音 基礎日文">
                                            <div class="carousel-caption d-none d-md-block">
                                            </div>
                                        </div>

                                        <div class="carousel-item">
                                            <img src="~/image/banner-5.jpg" class="d-block w-100"
                                                 alt="" onclick="redirectToDetailPage4()" title="韓文會話">
                                            <div class="carousel-caption d-none d-md-block">
                                            </div>
                                        </div>
                                     
                                    </div>
                                    <button class="carousel-control-prev" type="button"
                                            data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button"
                                            data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr style="color:brown">


                    <div class="setting">
                        <!-- 標題 -->
                        <div class="setting-title">常用功能</div>

                        <!-- 內容1 按鈕/超連結功能-->
                        <div class="container">
                            <div class="row setting-content">
                                <div class="col-sm-3">

                                    <div >
                                        <a class="btn btn-primary" href="~/member/consumptionrecord">
                                            <span style=" color:aliceblue; font-size: 27px;">消費紀錄</span>
                                        </a>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div >
                                        <a class="btn btn-primary" href="~/member/MyCoupons"><span style=" color:aliceblue; font-size: 27px;">我的優惠券</span></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr style="color:brown">


                    <div class="setting">
                        <!-- 標題 -->
                        <div class="setting-title">我的課程</div>

                        <!-- 內容1 按鈕/超連結功能-->
                        <div class="container">
                            <div class="row setting-content">
                                <div class="col-sm-3">
                                    <div >
                                        <a class="btn btn-primary" href="~/member/Calendar"><span style=" color:aliceblue; font-size: 27px;">查看行事曆</span></a>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div >
                                        <a class="btn btn-primary" href="~/member/TutorRecord"><span style=" color:aliceblue; font-size: 27px;">課程紀錄</span></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
            <!-- 個人資料介面 -->


            <div class="hiMember fonttfffff" data-aos="fade-left" style="margin-top:23px">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-md-6 setting-content">
                            <div class="tindexphoto-container">
                                @if (user.ImageName == null) user.ImageName = "default.jpg";
                                <img class="tindexphoto" src=" @Url.Content("~/uploads/")@user.ImageName" alt="teacher"
                                     title="" />
                            </div>
                        </div>
                        <div class="col-md-6 setting-content" style="color:peru">
                            <p style="margin-bottom:20px;font-size:20px">Hello</p>
                            <p style="margin-bottom:20px;font-size:20px">@user.Name</p>
                            <p style="font-size:20px">歡迎回來</p>
                        </div>

                    </div>
                </div>

                <hr style="margin-bottom: 30px;color:peru">

                <div>
                    <a href="~/Member/BasicInfoManage" class="btn btn-primary"
                       style="margin-left:37px;margin-bottom:15px;font-size:20px">會員資料管理</a>

                    <a class="btn btn-primary"
                       style="margin-left: 37px;margin-bottom:15px;font-size:20px"
                       href="~/member/ReserveTutorPeriod">預約課程</a>

                    <a asp-action="index" asp-controller="Member" class="btn btn-primary"
                       style="margin-left: 37px;margin-bottom:15px;font-size:20px">回首頁</a>


                </div>
            </div>



        </div>
    </div>
</main>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
    AOS.init();
</script>
<!-- 浮動效果 -->
@section Scripts{
    <script>
        const top4 = document.querySelector("#top4")
        const top8 = document.querySelector("#top8")
        const top12 = document.querySelector("#top12")
        const top16 = document.querySelector("#top16")
        async function GetPic() {
            const pi = await fetch("https://localhost:7016/api/TeachersResumes/GetResumeList")
            const data = await pi.json();
            console.log(data)
            const pics = data.map(function (item, index) {
                console.log(item, index)
                //判斷index數字為多少

                //小於4加入到carousel-item Id屬性的innerHTML中
                if (index < 4) 
                {
                    top4.innerHTML += `<figure class="carousel-teacher mx-5">
                    <img src='@Url.Content("~/uploads/")${item.imageName}' title="${item.name}"
                         onclick="redirectToTeacherDetail(${item.teacherId})"/>
                         </figure>`
                }
                //小於10加入到第二個carousel-item Id屬性的innerHTML中
                if (index > 3 && index<8) 
                {
                    top8.innerHTML += `<figure class="carousel-teacher mx-5">
                    <img src='@Url.Content("~/uploads/")${item.imageName}' title="${item.name}"
                                  onclick="redirectToTeacherDetail(${item.teacherId})">
                                               </figure>`
                }
                if (index > 9 && index < 14) {
                    top12.innerHTML += `<figure class="carousel-teacher mx-5">
                    <img src='@Url.Content("~/uploads/")${item.imageName}' title="${item.name}"
                                    onclick="redirectToTeacherDetail(${item.teacherId})">
                                               </figure>`
                }
                if (index > 13 && index < 18) {
                    top16.innerHTML += `<figure class="carousel-teacher mx-5">
                    <img src='@Url.Content("~/uploads/")${item.imageName}' title="${item.name}"
                                     onclick="redirectToTeacherDetail(${item.teacherId})">
                                                       </figure>`
                }

            })
        }
        GetPic();

        function redirectToDetailPage2() {
            window.location.href = '/Article/Detail/2';
        }
        function redirectToDetailPage3() {
            window.location.href = '/Article/Detail/3';
        }
        function redirectToDetailPage4() {
            window.location.href = '/Article/Detail/4';
        }

        function redirectToTeacherDetail(teacherId) {
            window.location.href = `/TeacherList/Info/${teacherId}`
        }
    </script>

}

